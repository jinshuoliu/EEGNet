# EEGNet

[这篇论文的来源](https://www.researchgate.net/publication/310953136_EEGNet_A_Compact_Convolutional_Network_for_EEG-based_Brain-Computer_Interfaces)

**题目：** EEGNet:一个紧凑的卷积神经网络

## 1. 摘要

- 背景：
  - BCI使神经活动与计算机进行直接通信
  - 由于EEG控制信号的不同，设计不同的特征提取器和分类器
  - CNN虽然已经很好了，但是只能应用于单个BCI范式，尚不能推广
- 目的：
  - 来设计一个单一的CNN架构来准确分类来自不同BCI范式的EEG信号
  - (而且尽可能紧凑，这个紧凑什么意思呢？体现在模型中的参数数量上)
- 模型：
  - EEGNet：基于EEG的BCI紧凑型卷积神经网络
- 构建：
  - 引入了深度卷积和可分离卷积来构建特定于脑电的模型
  - 模型封装了脑电特征提取概念
- 目前最先进的四种BCI范式的方法：
  - P300视觉诱发电位
  - 错误相关负性反应(ERN)
  - 运动相关皮质电位(MRCP)
  - 感觉运动节律(SMR)
- EEGNet和上面四种BCI范式比较结果：
  - 训练数据有限时，EEGNet的跨范式泛化效果较好，性能高
  - EEGNet有效的推广到ERP和基于震荡的bci
- 通过三种不同的方法来可视化训练过的EEGNet模型
- 意义：
  - EEGNet足够健壮
  - 可以在一系列BCI任务中学习各种可解释特征

## 2. 背景介绍

### 2.1. 脑机接口传统应用：

- 在医学应用于人工假肢等方向
- 新兴：
  - 通过EEG的无创方法为健康用户提供帮助
- CNN的强大使得逐渐替代人工特征提取
    - 但是之前的研究只是集中在单个BCI任务的分类，对特定任务设计特定的网络架构
    - 训练网络的数据量大小也会导致差异

### 2.2. BCI的五个处理阶段：

- 数据收集阶段，记录神经数据(通常使用公开数据或者实验室的数据)
- 信号处理阶段，对数据进行预处理(我们目前从这里开始)
- 特征提取阶段，从神经数据中提取有用信息
- 分类阶段，根据数据解决策略分类(EEGNet就是帮助我们进行分类)
- 反馈阶段，将决策的结果反馈给用户

### 2.3. EEGNet

在前面的基础上，我们提出了EEGNet

- 一个紧凑的CNN，用于分类和解释两个基于eeg的bci
- 引入了深度卷积和可分离卷积的使用，来构建一个特定的脑电图网络
  - 该网络封装了几个著名的脑电图特征提取概念(如最佳空间滤波和滤波器库构建)
- 减少了可训练参数拟合的数量

### 2.4. 研究

- 评估EEGNet对四种不同BCI范式的脑电图数据的通用性
- 每个数据集合包含不同数量的数据，探索EEGNet对各种大小的训练数据的有效性

### 2.5. 研究结果

- 训练数据有限时，EEGNet能取得更好的性能
- EEGNet可以有效的跨所有测试范例进行泛化
- EEGNet的表现于特定于范式的EEG CNN模型一样好，拟合参数少了两个数量级
  - 表明模型参数的使用更加有效
- 通过特征可视化和模型消融分析
  - 可以从EEGNet模型中提取神经生理学可解释的特征
    - 这点的重要性：
    - 因为cnn，尽管具有鲁棒性和自动特征提取，但是它们会产生不知道如何解释的特征

## 3. 数据和方法

### 3.1. 数据简述

**主要是验证CNN模型的四个数据集的简述**

bci分类：

- 事件相关型
- 震荡型

事件相关型(ERP)：

- 事件相关电位(ERP)bci旨在检测已知的、时间锁定的外部刺激引起的高振幅和低频脑电图反应
- 它们在各受试者之间都是稳健的，包含良好的刻板印象波形，使ERP时间进程能通过机器学习有效的建模

震荡型(Oscillatory)：

- 利用特定的脑电图频段的信号功率进行外部控制，通常为异步
- 当震荡信号被外部刺激定时锁定时，它们可以通过时间相关谱摄动分析来表示
- 震荡型bci比较难训练，通常是由于较低的信噪比(SNR)以及来自不同受试者造成较大差异

|范例|功能类型|带通滤波器|# of Subjects|实验/Subject|# of Classes|Class不平衡？|
|--|--|--|--|--|--|--|
|P300|ERP|1-40Hz|15|~2000|2|Yes,~5.6:1|
|ERN|ERP|1-40Hz|26|340|2|Yes,~3.4:1|
|MRCP|ERP/Oscillatory|0.1-40Hz|13|~1100|2|No|
|SMR|Oscillatory|4-40Hz|9|288|4|NO|

- 表1：本研究的数据收集汇总
- class不平衡
  - 例如2:1的概率意味着类失衡，1类数据占总数居的2/3，2类数据占总数居的1/3
  - 对于P300和ERN数据集，class失衡与subject相关
    - 因此，odds被认为是所有subject的平均class失衡


#### 3.1.1. 数据集1：P300事件相关电位

数据集说明：
 
- 18名参与者自愿参加RSVP BCI研究
- 研究人员以2hz的频率向参与者展示自然风景的图片
  - 图片中可能会出现车辆或人(目标)，可能不出现车辆或人(非目标)
  - 当目标图像出现时，参与者被要求用惯用手按下按钮
  - 目标/非目标比率为20%/80%
- 由于过多的伪影/噪声的存在，3名被试者的数据被排除，只剩下15名被试者的数据
  - 他们有9名男性，14名右撇子，年龄18-57(平均39.5)
  - EEG记录采用BioSemi Active Two系统以512hz的数字采样方式，从64个头皮电极以10-10蒙太奇的方式排列
  - 离线数据参考左右耳垂的平均值
  - 使用EEGLAB实现的FIR滤波器进行数字带通滤波到1-40Hz，下采样到128hz
  - 在刺激开始后[0,1]s提取目标和非目标条件下的EEG trials
  - 应用于两分类

数据集描述：

- P300事件相关电位是一种对新奇视觉刺激的刻板神经反应
- 它通常是由视觉古怪范式引起的
  - 参与者被展示出重复的非目标视觉刺激
  - 这些非目标视觉刺激以固定的呈现速率(如1hz)穿插在不频繁的目标刺激中
- 在顶叶皮层上观察到的P300波形是刺激开始后大约300毫秒观察到的电活动的一个大的正偏转
  - 偏转强度与目标刺激的频率成反比(出现频率越低，偏转越强烈)
- P300ERp是EEG观察到的最强的神经信号之一
- 当图像呈现速率增加到2hz或更高，被称为快速串行视觉呈现(REVP)

#### 3.1.2. 数据集2：反馈错误相关的消极性(ERN)

数据集说明：

- 26名健康的参与者(16名用于训练，10名用于测试)参加一项P300拼写任务
  - 该任务是使用一组随机闪烁的字母序列，排列在6*6网格中，用来引出P300的反应
  - 挑战者的目标是确定P300拼写者的反馈是正确的还是错误的
- 最初是在600hz下使用56个被动Ag/AgCl EEG传感器记录的，随后使用扩展的10-20系统放置电极
- 先使用EEGLAB中的FIR滤波器对EEG数据进行带通滤波到1-40Hz，下采样到128Hz
- 在[0, 1.25]s的反馈呈现后提取正确和错误反馈的EEG实验，作为两分类特征

数据集描述：

- 它是在受试者的环境或任务中发生错误或不寻常事件后对EEG造成的扰动
- 它们可以在各种任务中观察到(时间间隔产生范式和强制选择范式)
- 我们关注ERN，这是一种EEG振幅扰动后，感知到由脑电接口产生的错误反馈
  - 反馈ERN的特征是：在视觉反馈后，大约350ms为负误差分量，大约500ms为正误差分量
- 反馈ERN的检测提供了一种机制来推断，并可能实时纠正BCI的错误输出
- 已被证明可提高在线应用中P300拼写器的性能

#### 3.1.3. 数据集3：运动相关皮层电位(MRCP)

数据集说明：

- 13名受试者使用左食指、左中指、右食指和右中值进行自定步调的手指运动
- 使用256通道BioSemi Active II系统以1024Hz记录数据
- 使用PREP管道对EEG数据进行处理(由于存在大量信号噪声)
- 数据参考连接乳突，使用EEGLAB的FIR滤波器进行带通滤波，到0.1Hz到40Hz之间，下采样到128Hz
  - 再进一步向下采样通道空间到标准的64通道生物半蒙太奇
- 将每只手的食指和中指块进行组合，对起源于左手或右手的5种运动进行二分类

数据集描述：

- 神经活动会包含ERP和震荡成分
  - 运动相关皮层电位就是这样
  - 它可以由手脚的随意运动引起，可以通过脑电图沿着手脚运动对策的中央和中线电极观察到
- MRCP可以看到
  - 在运动开始前
    - 缓慢的 0-5Hz 准备就绪
    - 潜在的和 10-12Hz 频带中的早期失步
  - 在运动开始
    - 慢运动电位
  - 运动结束后
    - 运动执行后约 1 秒，20-30Hz 活动的延迟同步
- MRCP 以前曾被用于为健康和身体残疾的患者开发运动控制 BCI

#### 3.1.4. 数据集4：感觉运动节律(SMR)

数据集说明：

- 数据来自BCI Competition IV数据集
- 由9名受试者记录的左右手、脚和舌头的四类运动想象组成
- 最初使用22个Ag/AgCl电极记录EEG数据
  - 以250Hz采样，并在0.5-100Hz之间进行带通滤波，降采样到128Hz
- 在线索出现后的[0.5, 2.5]秒记录数据

数据集描述：

- 基于振荡的 BCI 的一个常见控制信号是感觉运动节律
- 其中mu(8-12Hz)和beta(18-26Hz)频带在与实际或运动想象对侧的感觉运动皮层上同步
- SMR和MRCP的震荡分量非常相似
- SMR在受试者之间和受试者内部很弱，变化很大，需要长时间校准

### 3.2. 分类方法

- 描述了EEGNet模型以及在模型比较中使用的其他BCI模型

#### 3.2.1. EEGNet：紧凑的CNN架构

**在这里，首先介绍EEGNet**这是一种基于EEG的BCI的紧凑CNN架构

1. 可以应用与多种不同的BCI范式
2. 可以使用非常优先的数据进行训练(对数据量小的数据集友好)
3. 可以产生神经生理学上可以解释的特征(便于理解)

**EEGNet模型：**

EEGNet模型可视化

![visualization](/MD/assert/3-2-1-EEGNet_visualization.png)



**数据以及设定的环境：**

- 模型用于以128Hz采样率采集的EEG试验，具有C通道和T时间样本
- 使用Adam优化器拟合模型，使用默认参数，最小化分类交叉熵损失函数
- 运行500次训练迭代，并执行验证停止，保存产生最低验证集损失的模型权重
- 所有模型均在NVIDIA Quadro M6000 GPU上进行训练，CUDA 9 和cuDNN v7版本的tensorflow，使用Keras API

### 3.3. 数据分析



### 3.4. EEGNet功能可解释性



## 4. 结果

- 展示了学科内和跨学科分类表现的结果，以及特征可解释性分析的结果
